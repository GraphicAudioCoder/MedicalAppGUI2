function lang = LanguageManager(action, varargin)
    persistent currentLanguage;

    if (nargin == 0) || strcmp(action, 'get')
        if isempty(currentLanguage)
            currentLanguage = loadLanguage('EnglishLang.m');
        end
        lang = currentLanguage;
    elseif strcmp(action, 'setLanguage')
        if strcmpi(varargin{1}, 'Italiano')
            currentLanguage = loadLanguage('ItalianLang.m');
        else
            currentLanguage = loadLanguage('EnglishLang.m');
        end
        lang = currentLanguage;
    else
        error('Invalid LanguageManager action: %s', action);
    end
end

function lang = loadLanguage(filePath)
    run(filePath);
    lang = struct(...
        'NEXT_BUTTON_TEXT', NEXT_BUTTON_TEXT, ...
        'HELP_BUTTON_TOOLTIP', HELP_BUTTON_TOOLTIP, ...
        'USER_MODE_LABEL', USER_MODE_LABEL, ...
        'TEST_LABEL', TEST_LABEL, ...
        'USER_BUTTON_TEXT', USER_BUTTON_TEXT, ...
        'DEVELOPER_BUTTON_TEXT', DEVELOPER_BUTTON_TEXT, ...
        'BLOCK_BUTTON_TEXT', BLOCK_BUTTON_TEXT, ...
        'PATIENT_LABEL', PATIENT_LABEL, ...
        'ENVIRONMENT_LABEL', ENVIRONMENT_LABEL, ...
        'LISTENER_LABEL', LISTENER_LABEL, ...
        'TARGET_SPEAKER_LABEL', TARGET_SPEAKER_LABEL, ...
        'MASKING_NOISE_LABEL', MASKING_NOISE_LABEL, ...
        'TEST_SETTINGS_LABEL', TEST_SETTINGS_LABEL, ...
        'NEW_LABEL', NEW_LABEL, ...
        'OPEN_LABEL', OPEN_LABEL, ...
        'NAME_LABEL', NAME_LABEL, ...
        'SURNAME_LABEL', SURNAME_LABEL, ...
        'BIRTHDAY_LABEL', BIRTHDAY_LABEL, ...
        'PREVIOUS_CLINICAL_HISTORY_LABEL', PREVIOUS_CLINICAL_HISTORY_LABEL, ...
        'NOTES_LABEL', NOTES_LABEL, ...
        'SAVE_PATIENT_AND_DATA_LABEL', SAVE_PATIENT_AND_DATA_LABEL, ...
        'WELCOME_TEXT', WELCOME_TEXT, ...
        'ACOUSTICAL_SPECS_LABEL', ACOUSTICAL_SPECS_LABEL, ...
        'SELECT_BUTTON_TEXT', SELECT_BUTTON_TEXT, ...
        'SELECTED_ENVIRONMENT_LABEL', SELECTED_ENVIRONMENT_LABEL, ...
        'MISSING_NAME_SURNAME', MISSING_NAME_SURNAME, ...
        'MISSING_NAME', MISSING_NAME, ...
        'MISSING_SURNAME', MISSING_SURNAME, ...
        'DATA_SAVED_SUCCESSFULLY', DATA_SAVED_SUCCESSFULLY, ...
        'NONEXISTENT_PATIENT', NONEXISTENT_PATIENT, ...
        'SELECTED_LISTENER_LABEL', SELECTED_LISTENER_LABEL, ...
        'LISTENER_ELEVATION_LABEL', LISTENER_ELEVATION_LABEL, ...
        'LISTENER_AZIMUTH_LABEL', LISTENER_AZIMUTH_LABEL ...
    );
end
